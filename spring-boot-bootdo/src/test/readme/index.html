<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>文档</title>
  <link href="css/semantic/semantic.min.css" rel="stylesheet">
  <link href="css/markdown.css" rel="stylesheet">
  <style>
    body{padding-top:0;background:#f7f7f7}
    body>.ui.container{width:100%;padding:0}
    #project-title{background:#6e6e6e;width:100%;line-height:3.572rem;color:#fff;font-size:1.2rem}
    #project-title .title-wrap{font-weight:700;padding:0 12px;width:100%;max-width:1366px!important;min-width:900px;margin:0 auto}
    #project-title .left,#project-title right{display:inline-block}
    #project-title .right{float:right}
    #project-title .right .wiki-actions .menu{left:auto;right:0;margin-top:.4em!important}
    #wiki-preview-container{width:100%;max-width:1366px!important;min-width:900px;padding:0;border:1px solid #e3e9ed;border-top:0}
    #wiki-preview>.ui.segment{margin-top:0;padding:1rem;padding-left:0;border:0}
    .hover-places{display:inline-block}
    #page-detail{width:60%;margin:0 auto}
    #page-detail .title{font-weight:700;font-size:24px;padding:12px 0;border-bottom:1px solid #ccc}
    #page-detail .content{margin-top:15px}
    .content p{word-wrap:break-word}
    #wiki-parent,#wiki-title,#wikis{display:none}
    .ui.grid{padding:0!important}
    #ex-all{cursor:pointer;color:#537c8d}
  </style>
</head>
<body>
  <div class="ui container">
    <div id="project-title">
      <div class="title-wrap">
        <div class="left">
          <i class="icon eye"></i>
          文档预览:
          bootdo
        </div>
        <div class="right">
          Export by Gitee
        </div>
      </div>
    </div>

    <div class="ui container" id="wiki-preview-container">
      <div id="wiki-preview">
        <div class="ui segment">
          <div id="page-detail" class="markdown-body">
            <div class='title'>第一步，配置生成策略</div><div class='content'><p>1、打开代码生成模块，点击配置策略</p>

<p><img alt="输入图片说明" src="https://gitee.com/uploads/images/2017/1026/083809_ab05adc8_1204498.png" title="屏幕截图.png" /></p>

<p>2、指定作者，邮箱等信息等代码注释信息；</p>

<p>3、指定 <strong>包</strong> 名；</p>

<p>4、为了是代码简洁美观可选择自动去除表的前缀，或者去掉指定的表前缀。</p>
</div><div class='title'>第二部、生成代码并复制到项目中</div><div class='content'><div class="white"><div class="highlight"><pre> 关于为什么不直接生成到项目中，只要考虑到，如果生成策略配置不正确或者其他原因导致代码生成错误，或者生成的某些代码是不需要的，还需要手动删除，可能导致误删等情况。 
</pre></div></div>
<p>1、生成策略配置完成后，点击生成代码按钮或者批量删除按钮，自动生成对单表表单的增删改查模块。
2、复制到项目中，一般根据依赖关系，先复制pojo,dao,service,controller，然后是xml,html,js等静态资源。</p>
</div><div class='title'>Home</div><div class='content'><p>面向学习型的开源框架，简洁高效，减少过渡封装，展现技术本质!</p>

<p>项目地址(GitHub):<a href="https://github.com/lcg0124/bootdo">https://github.com/lcg0124/bootdo</a></p>

<p>项目地址(GitEE):<a href="https://gitee.com/lcg0124/bootdo">https://gitee.com/lcg0124/bootdo</a></p>
</div><div class='title'>BootDo打包war并部署外部Tomcat(Idea开发工具)</div><div class='content'><p><strong>注意修改BootdoApplication</strong> </p>

<ul class="task-list">
<li>只需要继承SpringBootServletInitializer 和 configure方法重写
<code>
public class BootdoApplication ** extends SpringBootServletInitializer** {
**    @Override
protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
    return builder.sources(BootdoApplication.class);
}** 
</code>
<strong>1.修改pom.xml文件打包方式为war</strong> 
<code>
&lt;groupId&gt;com.bootdo&lt;/groupId&gt;
&lt;artifactId&gt;bootdo&lt;/artifactId&gt;
&lt;version&gt;1.5.0&lt;/version&gt;
&lt;packaging&gt;war&lt;/packaging&gt;
</code>
<img alt="pom修改war打包方式" src="https://gitee.com/uploads/images/2018/0127/151715_fbbc0ce7_131538.jpeg" title="1.修改为war打包模式.jpg" /></li>
</ul>

<p><strong>2.移除springboot自带tomcat环境并添加servlet依赖</strong> </p>
<div class="white"><div class="highlight"><pre>&lt;!-- 移除嵌入式tomcat插件 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;!-- 添加servlet-api的依赖 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
    &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
    &lt;version&gt;2.5&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</pre></div></div>
<p><img alt="移除springboot自带tomcat环境并添加servlet依赖" src="https://gitee.com/uploads/images/2018/0127/151923_13a889da_131538.jpeg" title="2.移除springboot自带tomcat环境并添加servlet依赖.jpg" /></p>

<p><strong>3.bulid一下项目</strong> </p>

<p><img alt="bulid一下项目" src="https://gitee.com/uploads/images/2018/0127/155842_41a58db4_131538.jpeg" title="3.build项目.jpg" /></p>

<p><strong>4.项目进行maven package操作打包war文件</strong> </p>

<p><img alt="项目进行maven package操作打包war文件" src="https://gitee.com/uploads/images/2018/0127/155946_112e8ede_131538.jpeg" title="4.项目打包成war格式.jpg" /></p>

<p><strong>5.新建一个配置forTomcat</strong> </p>

<p><img alt="新建一个配置forTomcat" src="https://gitee.com/uploads/images/2018/0127/160258_01b18f2a_131538.jpeg" title="5.添加Tomcat服务器.jpg" /></p>

<p><strong>6.点击＋号，下拉选择Tomcat Server-Local</strong> </p>

<p><img alt="选择Tomcat Server" src="https://gitee.com/uploads/images/2018/0127/160322_c91216c0_131538.jpeg" title="5.添加一个Tomcat服务.jpg" /></p>

<p><strong>7.显示idea已经配置的Tomcat相关信息，端口等</strong> </p>

<p><img alt="Tomcat相关信息" src="https://gitee.com/uploads/images/2018/0127/160412_01567c00_131538.jpeg" title="6.默认读取idea配置的tomcat内容.jpg" /></p>

<p><strong>8.切换至Deployment 点击＋号，点击artifact添加项目</strong> </p>

<p><img alt="artifact添加项目" src="https://gitee.com/uploads/images/2018/0127/160452_a7c3875b_131538.jpeg" title="7.artifact项目.jpg" /></p>

<p><strong>9.添加打包成war的项目</strong> </p>

<p>war模式：将WEB工程以包的形式上传到服务器；</p>

<p>war exploded模式：将WEB工程以当前文件夹的位置关系上传到服务器；选择war exploded
<img alt="添加打包成war的项目" src="https://gitee.com/uploads/images/2018/0127/160607_92cb5c17_131538.jpeg" title="8.添加刚才打包好的项目.jpg" /></p>

<p><strong>10.添加完成截图示意</strong> </p>

<p>可以在application context修改访问项目的路径哦</p>

<p><img alt="添加完成截图示意" src="https://gitee.com/uploads/images/2018/0127/160744_1d040739_131538.jpeg" title="9.添加完成的截图.jpg" />
 <strong>11.点击运行即可</strong> </p>

<p>点击绿色倒三角会启动项目并自动打开浏览器跳转到项目index页面 </p>

<p><img alt="运行即可" src="https://gitee.com/uploads/images/2018/0127/160846_f976268e_131538.jpeg" title="9点击运行即可.jpg" /></p>
<h3><a class="anchor" id="常见问题" href="#常见问题"></a>常见问题</h3>
<ul class="task-list">
<li>FileController.java报错
<code>
org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;fileController&#39;: Failed to introspect bean class [com.xai.common.controller.FileController] for lookup method metadata: could not find class that it depends on; nested exception is java.lang.NoClassDefFoundError: org/apache/catalina/servlet4preview/http/HttpServletRequest
</code></li>
<li>解决方法：
<code>
删除FileController.java 中import org.apache.catalina.servlet4preview.http.HttpServletRequest;
导入javax中的servlet import javax.servlet.http.HttpServletRequest;
</code></li>
</ul>

<p>以上就是bootdo打包成war并部署外部Tomcat图文步骤整理</p>
</div><div class='title'>关闭activiti自动建表</div><div class='content'><p><img alt="输入图片说明" src="https://gitee.com/uploads/images/2018/0521/115322_9699101c_1204498.png" title="屏幕截图.png" />
设置成false</p>
</div><div class='title'>启动项目</div><div class='content'><p>1、找到配置文件application.yml</p>

<p><img alt="输入图片说明" src="https://git.oschina.net/uploads/images/2017/1011/172440_1a6ea36b_1204498.png" title="屏幕截图.png" /></p>

<p>2、更改数据库
<img alt="输入图片说明" src="https://git.oschina.net/uploads/images/2017/1011/172534_e9c44917_1204498.png" title="屏幕截图.png" /></p>

<p>3、找到BootdoApplication直接运行
<img alt="输入图片说明" src="https://git.oschina.net/uploads/images/2017/1011/172333_447c9dbd_1204498.png" title="屏幕截图.png" /></p>

<p>4、启动成功</p>

<p>5、访问localhost</p>
</div><div class='title'>第一步、添加菜单</div><div class='content'><p><img alt="输入图片说明" src="https://gitee.com/uploads/images/2018/0108/163854_0a8b4ab8_1204498.png" title="屏幕截图.png" /></p>
</div><div class='title'>session支持ehcache和redis</div><div class='content'><p>配置文件制定cacheType，切换缓存类型</p>
</div><div class='title'>第二部、添加权限</div><div class='content'><p><img alt="输入图片说明" src="https://gitee.com/uploads/images/2018/0108/164145_2bdacb79_1204498.png" title="屏幕截图.png" /></p>
</div><div class='title'>权限模块</div><div class='content'></div><div class='title'>简易版Excel导出(小帅丶)</div><div class='content'></div><div class='title'>快速开始</div><div class='content'></div><div class='title'>第三部、设置菜单和权限</div><div class='content'><p>1、打开菜单管理模块，设置菜单，按钮等信息。
<img alt="输入图片说明" src="https://gitee.com/uploads/images/2017/1026/085432_0cb54084_1204498.png" title="屏幕截图.png" />
2、打开角色管理模块，给指定角色添加打开该模块的权限。  <em>注意，权限信息做了缓存，重启登录系统才能有效</em> </p>
</div><div class='title'>war包使用root部署</div><div class='content'><p>war包使用root部署
因为tomcat的server.xml配置的path 配置成了 "/"而Tomcat在启动的时候会去webapps下访问它默认的ROOT应用程序，其实这就是它在conf/server.xml中配好的默认规则，如果你想让Tomcat启动时默认打开你自己的web应用，最简单的做法就是不去改他的配置，只需要</p>

<p>1.将webapps目录下ROOT文件夹删除掉</p>

<p>2.copy你的war包到webapps目录下，并更名为ROOT</p>

<p>3.启动Tomcat</p>

<p>4.访问 <a target="_blank" href="http://localhost/">http://localhost/</a> 就是你的项目首页了</p>
</div><div class='title'>导入项目</div><div class='content'><h3><a class="anchor" id="eclipse" href="#eclipse"></a><strong>eclipse</strong>
</h3>
<p>1、从Eclipse中选择File-&gt;import-&gt;Git-&gt;Projects from Git
<img alt="输入图片说明" src="https://git.oschina.net/uploads/images/2017/1005/165734_404b200a_1204498.png" title="屏幕截图.png" />
2、Next-&gt;URL-&gt;Next
<img alt="输入图片说明" src="https://git.oschina.net/uploads/images/2017/1005/165915_d0d86d80_1204498.png" title="屏幕截图.png" />
3、配置本地项目存放路径，Next
<img alt="输入图片说明" src="https://git.oschina.net/uploads/images/2017/1005/170033_94d6e4bf_1204498.png" title="屏幕截图.png" /></p>

<p>4、等待项目导入到本地然后关闭</p>

<p>5、从Eclipse中选择File-&gt;import-&gt;Existring Maven Projects</p>

<p>6、选择之前导入的路径，完成</p>
<h3><a class="anchor" id="idea" href="#idea"></a><strong>idea</strong>
</h3>
<p>1、从idea中选择new-&gt;project from version control-&gt;git
<img alt="输入图片说明" src="https://gitee.com/uploads/images/2017/1019/165547_4331a323_1204498.png" title="屏幕截图.png" /></p>
</div><div class='title'>部署</div><div class='content'></div><div class='title'>非root部署，改造方案</div><div class='content'><p>需要设置context-path或者外置tomcat非root部署的同学可以采用此方案
<img alt="输入图片说明" src="https://gitee.com/uploads/images/2017/1127/182802_a9656d35_1204498.png" title="屏幕截图.png" /></p>

<p><img alt="输入图片说明" src="https://gitee.com/uploads/images/2017/1127/182816_6de10914_1204498.png" title="屏幕截图.png" /></p>

<p><img alt="输入图片说明" src="https://gitee.com/uploads/images/2017/1127/182824_271e9b2a_1204498.png" title="屏幕截图.png" /></p>
</div><div class='title'>推荐jar包部署，方法很运行普通jar包一样</div><div class='content'><p>java -jar</p>
</div><div class='title'>war部署外部Tomcat</div><div class='content'></div><div class='title'>代码生成</div><div class='content'></div><div class='title'>关于缓存</div><div class='content'></div><div class='title'>添加菜单</div><div class='content'></div><div class='title'>列表数据Excel导出</div><div class='content'><p>列表数据Excel导出</p>

<ul class="task-list">
<li>需要用的jar
<code>
    &lt;!--xxl-excel --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.xuxueli&lt;/groupId&gt;
        &lt;artifactId&gt;xxl-excel&lt;/artifactId&gt;
        &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;/dependency&gt;
</code></li>
<li>xxl-excel默认必须指定导出的文件路径，为了避免这个问题。我们自行增加一个方法
```</li>
</ul>

<p>import java.io.OutputStream;
import java.util.List;</p>

<p>import org.apache.poi.ss.usermodel.Workbook;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;</p>

<p>import com.xuxueli.poi.excel.ExcelExportUtil;</p>

<p>public class ExcelExportUtil4DIY extends ExcelExportUtil{
    private static Logger logger = LoggerFactory.getLogger(ExcelExportUtil.class);
      /**
     * 导出Excel文件到磁盘
     * <a href="/param" class="gfm gfm-team_member ">@chancelai </a> dataList
     * <a href="/param" class="gfm gfm-team_member ">@chancelai </a> outputStream
     */
    public static void exportToFile(List&lt;?&gt; dataList, OutputStream outputStream){
        // workbook
        Workbook workbook = exportWorkbook(dataList);
        try {
            // workbook 2 FileOutputStream
            workbook.write(outputStream);
            // flush
        } catch (Exception e) {
            logger.error(e.getMessage(), e);
            throw new RuntimeException(e);
        } finally {
            try {
                if (outputStream!=null) {
                    outputStream.close();
                }
            } catch (Exception e) {
                logger.error(e.getMessage(), e);
                throw new RuntimeException(e);
            }
        }
    }
}</p>
<div class="white"><div class="highlight"><pre>- 模块对应的JS做以下修改
</pre></div></div><div class="white"><div class="highlight"><pre>//导出Excel type导出的类型
//type 1 导出当页数据 2 导出全部数据 3 导出符合条件全部数据
function exportExcel(type) {
    //获取table的分页参数值
    var offset = $('#exampleTable').bootstrapTable('getOptions').pageSize;
    var limit = $('#exampleTable').bootstrapTable('getOptions').pageNumber * offset;
    data = 'limit='+limit+'&amp;offset='+offset;
    //后端导出的方法
    document.location.href = prefix + "/exportExcel?type="+type+"&amp;"+ data;
}
</pre></div></div><div class="white"><div class="highlight"><pre>- 模块对应的html做以下修改
</pre></div></div>
<p>
<i class="fa fa-export"></i>导出当页数据


<i class="fa fa-export"></i>导出全部数据


<i class="fa fa-export"></i>导出符合条件全部数据
</p>
<div class="white"><div class="highlight"><pre>- 模块对应Controller增加以下内容
</pre></div></div><div class="white"><div class="highlight"><pre>/**
 * 导出
 * @param request
 * @param response
 * @author 小帅丶
 * @return
 * @throws Exception
 */
@RequestMapping(value="/exportExcel")
public void exportExcel(@RequestParam Map&lt;String, Object&gt; params,HttpServletRequest request,HttpServletResponse response) throws Exception{
    SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
    String filename = "测试导出功能"+format.format(new Date().getTime())+".xls";
    response.setContentType("application/ms-excel;charset=UTF-8");
    response.setHeader("Content-Disposition", "attachment;filename="+new String(filename.getBytes(),"iso-8859-1"));
    OutputStream out = response.getOutputStream();
    try {
        Query query = new Query(params);
        String type = request.getParameter("type");
        //导出当前页面数据
        if(type.equals("1")){
            List&lt;XXXDO&gt; XxxDOs = XxxService.list(query);
            ExcelExportUtil4DIY.exportToFile(XxxDOs,out);
        }
        //导出全部数据
        if(type.equals("2")){
            List&lt;XXXDO&gt; XxxDOs = XxxService.list(null);
            ExcelExportUtil4DIY.exportToFile(XxxDOs,out);
        }
        //导出符合条件的全部数据
        if(type.equals("3")){
            query.remove("offset");
            query.remove("limit");
            List&lt;XXXDO&gt; XxxDOs = XxxService.list(query);
            ExcelExportUtil4DIY.exportToFile(XxxDOs,out);
        }
    } catch (Exception e) {
        e.printStackTrace();
        logger.info("exportExcel出错"+e.getMessage());
    }finally{
        out.close();
    }
}
</pre></div></div><div class="white"><div class="highlight"><pre></pre></div></div></div><div class='title'>关于activiti的常见问题</div><div class='content'></div><div class='title'>第三部、刷新页面、无效则关闭浏览器，重新登录</div><div class='content'><p>刷新页面、无效则关闭浏览器，重新登录</p>
</div>
          </div>
        </div>
      </div>
      </div>
  </div>
</body>
</html>